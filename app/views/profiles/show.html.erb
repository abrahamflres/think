<div class="container mt-5">
  <!-- Profile Header -->
  <div class="card mb-4 p-4">
    <div class="row align-items-center">
      <div class="col-md-3 text-center">
        <% if @profile.image.attached? %>
          <%= image_tag @profile.image, class: "img-fluid rounded-circle shadow-sm", style: "max-height: 150px;" %>
        <% else %>
          <p>No image</p>
        <% end %>
      </div>
      <div class="col-md-9">
        <h2 class="fw-bold"><%= "@#{@profile.username}"%></h2>
        <p class="mb-1 text-muted"><%= @profile.firstname %> <%= @profile.lastname %></p>
        <p class="fst-italic"><%= @profile.bio %></p>
        <%="Followers: #{@follower_count}"%>
        <%="Following: #{@following_count}"%>
        <% if @current_profile&.id == @profile.id %>
          <%= link_to "Edit Profile", edit_profile_path(@profile), class: "btn btn-outline-primary btn-sm me-2" %>
          <%= link_to "Account Settings", edit_user_registration_path, class: "btn btn-outline-secondary btn-sm" %>
        <%else%>
          <%= button_to "Follow", "#", class: "btn btn-primary"%>
        <% end %>
      </div>
    </div>

    <div class="heatmap">
      <% @engagement_data.each do |date, count| %>
        <% color_class = case count
          when 0 then "heatmap-day-0"
          when 1..2 then "heatmap-day-1"
          when 3..5 then "heatmap-day-2"
          else "heatmap-day-3"
        end %>
        <div class="heatmap-day <%= color_class %>"></div>
      <% end %>
    </div>

<div class="container mt-4">
  <% @articles.each do |a| %>
    <div class="card mb-3 shadow-sm">
      <div class="card-body">
        <h4 class="card-title"><%= a.title %></h4>
        <% if a.topic.present?%>
          <h5 class= "card-text"><%= "Topic: #{a.topic.title}"%></h5>
        <%else%>
          <h5 class="card-tect">Topic: null</h5>
        <%end%>
 
        <p class="text-muted mb-2">
          Published by <strong><%= a.profile.username %></strong> |
          <%= link_to "View Profile", profile_path(a.profile), class: "text-decoration-none" %>
        </p>
        <h6 class="text-muted"><%= a.profile.bio %></h6>
        <p class="card-text"><%= a.body %></p>

        <% if a.image.attached? %>
          <img src="<%= url_for(a.image) %>" class="img-fluid mb-3" alt="Article image">
        <% end %>


        <div class="d-flex align-items-center">
          <%= button_to "Like", profile_article_likes_path(a.profile, a), method: :post, class: "btn btn-outline-primary btn-sm me-2" %>
          <i class="fa-regular fa-thumbs-up me-1"></i>
          <%= a.likes_count %> <%= link_to "Show Post", profile_article_path(a.profile, a)%>
        </div>
      </div>
    </div>
  <% end %>
</div>
